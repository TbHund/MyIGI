{% extends 'base.html' %}
{% load phone_filters %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'main/css/pages/profile.css' %}">
{% endblock %}

{% block title %}Личный кабинет - Отель{% endblock %}

{% block content %}
<div class="profile-page">
    <div class="profile-info">
        <h1>Личный кабинет</h1>
        <div class="user-details">
            <h2>Информация о клиенте</h2>
            <div class="info-grid">
                <div class="info-item">
                    <span class="label">ФИО:</span>
                    <span class="value">{{ user.client.get_full_name }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Email:</span>
                    <span class="value">{{ user.email }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Телефон:</span>
                    <span class="value">{{ user.client.phone_number|phone_format }}</span>
                </div>
                {% if user.client.comments %}
                <div class="info-item full-width">
                    <span class="label">Комментарии:</span>
                    <span class="value">{{ user.client.comments }}</span>
                </div>
                {% endif %}
            </div>
            <div class="edit-profile-button">
                <a href="{% url 'edit_profile' %}" class="button">Редактировать профиль</a>
            </div>
        </div>

        <div class="bookings">
            <h2>Мои бронирования</h2>
            {% if bookings %}
                {% for booking in bookings %}
                <div class="booking-card">
                    <div class="booking-header">
                        <h3>{{ booking.room.category.name }} - Номер {{ booking.room.number }}</h3>
                        <span class="status {{ booking.status }}">{{ booking.get_status_display }}</span>
                    </div>
                    
                    <div class="booking-details">
                        <div class="dates">
                            <div class="check-in">
                                <span class="label">Заезд:</span>
                                <span class="value">{{ booking.check_in_date }}</span>
                            </div>
                            <div class="check-out">
                                <span class="label">Выезд:</span>
                                <span class="value">{{ booking.check_out_date }}</span>
                            </div>
                            {% if booking.actual_check_out_date %}
                            <div class="actual-check-out">
                                <span class="label">Фактический выезд:</span>
                                <span class="value">{{ booking.actual_check_out_date }}</span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="room-info">
                            <p class="capacity">Вместимость: {{ booking.room.capacity }} чел.</p>
                            <p class="price">Стоимость: {{ booking.total_price }} BYN</p>
                        </div>

                        {% if booking.comments %}
                        <div class="booking-comments">
                            <span class="label">Комментарии:</span>
                            <p>{{ booking.comments }}</p>
                        </div>
                        {% endif %}

                        {% if booking.status == 'active' %}
                        <div class="booking-actions">
                            <a href="{% url 'cancel_booking' booking.id %}" class="cancel-booking-button" 
                               onclick="return confirm('Вы уверены, что хотите отменить бронирование?')">
                                Отменить бронирование
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p class="no-bookings">У вас пока нет бронирований</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %} 